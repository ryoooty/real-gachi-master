# Workout Planner Bot (aiogram + APScheduler)

Демонстрационный бот реализует требования плана:

- Хранение профиля, недельных планов и дневных логов в SQLite.
- Конвертация пользовательского времени в UTC через `zoneinfo` и планирование задач APScheduler по UTC.
- Еженедельная генерация плана (заглушка DeepSeek) с возможностью программного усиления при отклике «легко».
- Reply-меню для навигации и Inline чек-листы упражнений с динамическими галочками и оценкой сложности.

## Запуск

```bash
pip install -r requirements.txt
python -m app.bot  # В main() используется токен-заглушка, подставьте свой
```

## Основные файлы

- `app/database.py` — создание схемы и доступ к таблицам `users`, `weekly_plan`, `daily_logs`.
- `app/time_utils.py` — конвертация локального времени пользователя в UTC без ручной арифметики.
- `app/ai.py` — клиент и парсер недельного плана DeepSeek с корректировкой нагрузок.
- `app/keyboards.py` — Reply-меню и Inline-кнопки чек-листа/сложности.
- `app/scheduler.py` — обертка над APScheduler для ежедневных уведомлений по UTC.
- `app/bot.py` — FSM профиля, отправка чек-листов, обратная связь по сложности и начисление очков.

## Соответствие техническому плану

| Пункт плана | Статус | Комментарий |
| --- | --- | --- |
| База и меню (SQLite, Reply-клавиатура, FSM профиля) | ✅ | Таблицы `users`, `weekly_plan`, `daily_logs` и меню/состояния в `app/bot.py`. |
| Генерация плана AI + JSON | ⚠️ | Есть заглушка `DeepSeekClient.generate_weekly_plan`, но нет вызова реального API и нет сбора недельной статистики для промпта. |
| «Живой» чек-лист с галочками и оценкой сложности | ⚠️ | Инлайн-клавиатура и обработчики есть (`ExerciseCallback`, `DifficultyCallback`), но текст тренировки не отражает галочки, а пропуск дня фиксируется без выбора сложности. |
| Система очков и статистика | ⚠️ | Очки пишутся в `daily_logs` при выборе сложности, однако экран статистики из меню не реализован. |
| Scheduler и Timezones | ⚠️ | Время переводится в UTC и APScheduler запускается, но расписание не читает настройки пользователей и cron-задача еженедельной генерации не настроена. |
